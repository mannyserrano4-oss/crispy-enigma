<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Highway Bingo</title>
    <meta name="apple-mobile-web-app-title" content="Highway Bingo">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" type="image/png" href="icon.png">

    <style>
        :root {
            /* Day Mode */
            --bg-color: #f0f2f5;
            --tile-bg: #ffffff;
            --text-color: #333;
            --accent: #ff6b6b;
            --mark-color: #4cd137;
            --border-color: #dcdde1;
            --shadow: 0 4px 0 #b2bec3;
        }

        body.night-mode {
            /* Night Mode */
            --bg-color: #1e272e;
            --tile-bg: #2d3436;
            --text-color: #d2dae2;
            --accent: #ff9f43;
            --mark-color: #00d2d3;
            --border-color: #485460;
            --shadow: 0 4px 0 #000;
        }

        body {
            font-family: "Segoe UI", -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            transition: background-color 0.3s;
        }

        /* --- HEADER --- */
        header {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.05);
        }

        h1 { margin: 0; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 900; color: var(--accent); }

        .header-btn {
            background: var(--tile-bg);
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 2px 0 rgba(0,0,0,0.1);
        }

        /* --- THE GRID --- */
        #game-board {
            flex-grow: 1;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 6px;
            padding: 10px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .tile {
            background: var(--tile-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.7rem; /* Slightly smaller for more text */
            line-height: 1.1;
            font-weight: 700;
            padding: 4px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: transform 0.1s, background-color 0.2s;
            position: relative;
            word-wrap: break-word;
            overflow: hidden;
            hyphens: auto;
        }

        .tile:active { transform: translateY(4px); box-shadow: none; }

        /* Marked State (Dauber) */
        .tile.marked {
            background: var(--mark-color);
            color: white;
            border-color: var(--mark-color);
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        /* Free Space */
        .tile.free {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        /* --- CONTROLS --- */
        .controls {
            padding: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
            background: rgba(0,0,0,0.05);
        }

        .big-btn {
            background: var(--text-color);
            color: var(--bg-color);
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.3);
            cursor: pointer;
        }
        
        .big-btn:active { transform: translateY(4px); box-shadow: none; }

        /* --- CONFETTI --- */
        #confetti-canvas {
            position: absolute;
            top: 0; left: 0;
            pointer-events: none;
            width: 100%; height: 100%;
            z-index: 100;
        }

        /* --- WIN OVERLAY --- */
        #win-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            z-index: 50;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--accent);
            width: 80%;
            max-width: 300px;
        }
        
        body.night-mode #win-overlay { background: #2d3436; border-color: var(--mark-color); }

        #win-overlay.visible { transform: translate(-50%, -50%) scale(1); }
        
        .bingo-text { font-size: 3.5rem; margin: 0; color: var(--accent); font-weight: 900; }

        @media (max-height: 700px) {
            .tile { font-size: 0.6rem; }
            h1 { font-size: 1.2rem; }
        }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <header>
        <h1>Highway Bingo</h1>
        <button class="header-btn" onclick="toggleTheme()">ðŸŒ™</button>
    </header>

    <div id="game-board">
        </div>

    <div class="controls">
        <button class="big-btn" onclick="newGame()">New Board</button>
    </div>

    <div id="win-overlay" onclick="hideWin()">
        <h2 class="bingo-text">BINGO!</h2>
        <p style="font-weight: bold; font-size: 1.2rem;">Tap to keep playing</p>
    </div>

    <script>
        // --- 150+ ROAD TRIP ITEMS ---
        const roadItems = [
            // Vehicles
            "Police Car", "Ambulance", "Fire Truck", "Motorcycle", "Motorcycle with Sidecar",
            "Yellow Car", "Pink Car", "Lime Green Car", "Purple Car", "Orange Car",
            "Classic Car (Vintage)", "Convertible (Top Down)", "Tesla", "Jeep with Ducks",
            "VW Beetle (Punch Buggy)", "Smart Car", "Hummer", "Minivan with Stick Family",
            "School Bus", "City Bus", "Party Bus/Limo", "RV / Motorhome", "Camper Van",
            "Truck towing Boat", "Truck towing Jet Skis", "Truck towing Car",
            "FedEx Truck", "UPS Truck", "Amazon Prime Van", "Walmart Truck",
            "Coca-Cola Truck", "Pepsi Truck", "Lays/Chips Truck", "Gas Tanker",
            "Car Carrier (Full)", "Cement Mixer", "Garbage Truck", "Street Sweeper",
            "Mail Truck (USPS)", "Military Vehicle", "Tractor on Road", "UTV / ATV on Trailer",
            "U-Haul Truck", "U-Haul Trailer", "Flatbed Tow Truck", "Hearse",
            
            // Driving Behaviors / People
            "Dog Head out Window", "Dog in Truck Bed", "Cat in Car", "Feet on Dashboard",
            "Driver Singing", "Driver Eating", "Driver Picking Nose", "Someone Sleeping",
            "Wearing Sunglasses", "Wearing a Hat", "Talking on Phone", "Arguing Couple",
            "Kids Fighting in Back", "Baby Crying (Heard/Seen)", "Smoker (Arm out window)",
            "Person Changing Tire", "Police Pulled Someone Over", "Construction Worker",
            
            // Signs & Billboards
            "Waffle House Sign", "Cracker Barrel Sign", "Buc-ee's Sign", "McDonald's Arches",
            "Starbucks Sign", "Dollar General", "Walmart", "Home Depot / Lowe's",
            "Billboard: Lawyer/Injury", "Billboard: Jesus/Religious", "Billboard: Adult Store",
            "Billboard: Fireworks", "Billboard: Fast Food", "Billboard: Casino",
            "Speed Limit 70", "Speed Limit 55", "Speed Limit 45", "Mile Marker 100",
            "State Line Sign", "Welcome Center", "Rest Area 1 Mile", "Weigh Station Open",
            "Exit 69", "Exit 420", "Detour Sign", "Road Work Ahead", "Merge Left/Right",
            "Dip in Road", "Deer Crossing", "Falling Rocks", "Bridge Ices Before Road",
            "Gas Price < $3.00", "Gas Price > $4.00", "Adopt a Highway",
            
            // Environment / Infrastructure
            "Water Tower", "Cell Tower (Fake Tree)", "Wind Turbine", "Solar Farm",
            "Power Plant / Smoke", "Factory", "Silo / Barn", "Hay Bales",
            "Cow(s)", "Horse(s)", "Goat/Sheep", "Hawk/Eagle on Wire", "Vultures circling",
            "Dead Animal (Roadkill)", "Train / Railroad Tracks", "Tunnel", "Toll Booth",
            "Bridge over Water", "Graffiti on Bridge", "Abandoned Building", "Cemetery",
            "Airplane in Sky", "Helicopter", "Hot Air Balloon", "Chemtrails / Contrails",
            "Rain / Storm", "Rainbow", "Sunset / Sunrise", "Full Moon", "Palm Tree",
            
            // Car Details
            "Out of State Plate", "Alaska/Hawaii Plate", "Vanity Plate (Custom)",
            "Student Driver Sticker", "Baby on Board Sticker", "Political Sticker",
            "Sports Team Sticker", "Stick Family Sticker", "Honor Student Sticker",
            "Broken Headlight/Taillight", "Missing Hubcap", "Spare Tire on Car",
            "Dented Bumper", "Very Muddy Truck", "Very Dirty Car", "Spoiler (Wing)",
            "Roof Rack / Box", "Bicycles on Rack", "Kayak/Canoe on Roof",
            "Mattress on Roof", "Furniture in Trunk", "License Plate Hanging Off"
        ];

        let boardState = [];
        let markedIndices = []; 

        // --- ROBUST AUDIO ENGINE (iOS Fix) ---
        let audioCtx = null;

        function initAudio() {
            if (!audioCtx) {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                audioCtx = new AudioContext();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        // Play Sound with instant resume check
        function playSound(type) {
            initAudio(); // Force check every time logic runs

            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            const now = audioCtx.currentTime;

            if (type === 'mark') {
                // Happy "Ding"
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, now);
                osc.frequency.exponentialRampToValueAtTime(1000, now + 0.1);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now);
                osc.stop(now + 0.1);
            } else if (type === 'unmark') {
                // Lower "Bloop"
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(400, now);
                osc.frequency.linearRampToValueAtTime(200, now + 0.1);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.linearRampToValueAtTime(0.01, now + 0.1);
                osc.start(now);
                osc.stop(now + 0.1);
            } else if (type === 'win') {
                // Major Chord Fanfare
                [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.type = 'square';
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    
                    o.frequency.value = freq;
                    // Staggered start
                    const startTime = now + (i * 0.1);
                    g.gain.setValueAtTime(0.1, startTime);
                    g.gain.exponentialRampToValueAtTime(0.001, startTime + 0.5);
                    
                    o.start(startTime);
                    o.stop(startTime + 0.5);
                });
            }
        }

        // --- GAME LOGIC ---
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function newGame() {
            // Trigger audio unlock on the user interaction
            initAudio(); 

            // Pick 24 items (Center is free)
            const shuffled = shuffle([...roadItems]);
            const selected = shuffled.slice(0, 24);
            
            // Insert FREE SPACE at index 12
            selected.splice(12, 0, "FREE SPACE");
            
            boardState = selected;
            markedIndices = [12]; // Center starts marked
            
            renderBoard();
            document.getElementById('win-overlay').classList.remove('visible');
        }

        function renderBoard() {
            const grid = document.getElementById('game-board');
            grid.innerHTML = '';
            
            boardState.forEach((item, index) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.innerText = item;
                
                if (index === 12) tile.classList.add('free', 'marked');
                if (markedIndices.includes(index)) tile.classList.add('marked');
                
                tile.onclick = () => toggleTile(index);
                
                grid.appendChild(tile);
            });
        }

        function toggleTile(index) {
            if (index === 12) return; // Can't toggle free space
            
            const tile = document.getElementById('game-board').children[index];
            
            if (markedIndices.includes(index)) {
                // Unmark
                playSound('unmark');
                markedIndices = markedIndices.filter(i => i !== index);
                tile.classList.remove('marked');
            } else {
                // Mark
                playSound('mark');
                markedIndices.push(index);
                tile.classList.add('marked');
                checkWin();
            }
        }

        function checkWin() {
            // Winning Combinations (Indices 0-24)
            const wins = [
                // Rows
                [0,1,2,3,4], [5,6,7,8,9], [10,11,12,13,14], [15,16,17,18,19], [20,21,22,23,24],
                // Cols
                [0,5,10,15,20], [1,6,11,16,21], [2,7,12,17,22], [3,8,13,18,23], [4,9,14,19,24],
                // Diagonals
                [0,6,12,18,24], [4,8,12,16,20]
            ];

            const hasWin = wins.some(combo => combo.every(i => markedIndices.includes(i)));

            if (hasWin) {
                // Small delay so the tile lights up before the overlay covers it
                setTimeout(() => {
                    triggerWin();
                }, 100);
            }
        }

        function triggerWin() {
            playSound('win');
            fireConfetti();
            document.getElementById('win-overlay').classList.add('visible');
        }

        function hideWin() {
            document.getElementById('win-overlay').classList.remove('visible');
        }

        function toggleTheme() {
            document.body.classList.toggle('night-mode');
        }

        // --- CONFETTI ---
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    color: `hsl(${Math.random()*360}, 100%, 50%)`,
                    life: 150,
                    size: Math.random() * 8 + 4
                });
            }

            function animate() {
                ctx.clearRect(0,0,canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    if(p.life > 0) {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += 0.2; // Gravity
                        p.life -= 1;
                        ctx.fillStyle = p.color;
                        ctx.fillRect(p.x, p.y, p.size, p.size);
                        active = true;
                    }
                });
                if(active) requestAnimationFrame(animate);
            }
            animate();
        }

        // Init Logic on Load
        // We do NOT play sound here to avoid browser errors
        newGame(); 

    </script>
</body>
</html>
