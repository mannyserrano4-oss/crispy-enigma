<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Highway Bingo</title>
    <meta name="apple-mobile-web-app-title" content="Highway Bingo">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" type="image/png" href="icon.png">

    <style>
        :root {
            /* Day Mode */
            --bg-color: #f0f2f5;
            --tile-bg: #ffffff;
            --text-color: #333;
            --accent: #ff6b6b;
            --mark-color: #4cd137;
            --border-color: #dcdde1;
            --shadow: 0 4px 0 #b2bec3;
        }

        body.night-mode {
            /* Night Mode */
            --bg-color: #1e272e;
            --tile-bg: #2d3436;
            --text-color: #d2dae2;
            --accent: #ff9f43;
            --mark-color: #00d2d3;
            --border-color: #485460;
            --shadow: 0 4px 0 #000;
        }

        body {
            font-family: "Segoe UI", -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            transition: background-color 0.3s;
        }

        /* --- HEADER --- */
        header {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.05);
        }

        h1 { margin: 0; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 900; color: var(--accent); }

        .header-btn {
            background: var(--tile-bg);
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 2px 0 rgba(0,0,0,0.1);
        }

        /* --- THE GRID --- */
        #game-board {
            flex-grow: 1;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 8px;
            padding: 10px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .tile {
            background: var(--tile-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 2px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: transform 0.1s, background-color 0.2s;
            position: relative;
            word-wrap: break-word;
            overflow: hidden;
            hyphens: auto;
        }

        .tile:active { transform: translateY(4px); box-shadow: none; }

        /* Marked State (Dauber) */
        .tile.marked {
            background: var(--mark-color);
            color: white;
            border-color: var(--mark-color);
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        /* Free Space */
        .tile.free {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            font-size: 1rem;
            text-transform: uppercase;
        }

        /* --- CONTROLS --- */
        .controls {
            padding: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
            background: rgba(0,0,0,0.05);
        }

        .big-btn {
            background: var(--text-color);
            color: var(--bg-color);
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.3);
            cursor: pointer;
        }
        
        .big-btn:active { transform: translateY(4px); box-shadow: none; }

        /* --- CONFETTI --- */
        #confetti-canvas {
            position: absolute;
            top: 0; left: 0;
            pointer-events: none;
            width: 100%; height: 100%;
            z-index: 100;
        }

        /* --- WIN OVERLAY --- */
        #win-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            z-index: 50;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid var(--accent);
        }
        
        body.night-mode #win-overlay { background: #2d3436; border-color: var(--mark-color); }

        #win-overlay.visible { transform: translate(-50%, -50%) scale(1); }
        
        .bingo-text { font-size: 4rem; margin: 0; color: var(--accent); font-weight: 900; }

        /* Mobile Font Sizing */
        @media (max-height: 700px) {
            .tile { font-size: 0.65rem; }
            h1 { font-size: 1.2rem; }
        }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>

    <header>
        <h1>Highway Bingo</h1>
        <button class="header-btn" onclick="toggleTheme()">ðŸŒ™</button>
    </header>

    <div id="game-board">
        </div>

    <div class="controls">
        <button class="big-btn" onclick="newGame()">New Board</button>
    </div>

    <div id="win-overlay" onclick="hideWin()">
        <h2 class="bingo-text">BINGO!</h2>
        <p style="font-weight: bold; font-size: 1.2rem;">Tap to continue playing</p>
    </div>

    <script>
        // --- DATA ---
        const roadItems = [
            "Waffle House", "Cracker Barrel", "Police Car", "Ambulance", "Fire Truck",
            "Billboard: Lawyer", "Billboard: Jesus", "Billboard: Adult", "Construction Cone",
            "Speed Limit 70", "Mile Marker 100", "State Line Sign", "Rest Area",
            "Weigh Station", "Flat Tire on Road", "Shoe on Road", "Dead Animal",
            "Dog in Car", "Feet on Dash", "Singing Driver", "Texting Driver",
            "Out of State Plate", "Vanity Plate", "Stick Family", "Baby on Board",
            "Truck with Logs", "Car Carrier", "Tanker Truck", "Cement Mixer",
            "Motorcycle Group", "RV towing Car", "Camper Van", "School Bus",
            "Yellow Car", "Pink Car", "Classic Car", "Convertible (Top Down)",
            "Broken Headlight", "Bumper Sticker: Politics", "Bumper Sticker: Sports",
            "Roof Rack / Box", "Bicycles on Back", "Boat on Trailer", "Jet Skis",
            "Cow", "Horse", "Hawk / Eagle", "Vultures", "Palm Tree",
            "Wind Turbine", "Solar Panels", "Water Tower", "Silo", "Barn",
            "Graffiti on Bridge", "Tunnel", "Toll Booth", "Exit 69", "Exit 420",
            "Triple Trailer", "FedEx Truck", "UPS Truck", "Amazon Truck",
            "Walmart Truck", "Dollar General", "McDonalds Sign", "Starbucks",
            "Gas Price < $3", "Gas Price > $4", "Someone Sleeping", "U-Haul",
            "Car with Rust", "Missing Hubcap", "Spoiler (Wing)", "Muddy Truck"
        ];

        let boardState = []; // 25 items (0-24)
        let markedIndices = []; 

        // --- AUDIO ENGINE ---
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        document.body.addEventListener('touchstart', unlockAudio, { once: true });
        document.body.addEventListener('click', unlockAudio, { once: true });

        function unlockAudio() { if (audioCtx.state === 'suspended') audioCtx.resume(); }

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            if (type === 'mark') {
                // High blip
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
            } else if (type === 'unmark') {
                // Low blip
                osc.type = 'sine';
                osc.frequency.setValueAtTime(300, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
            } else if (type === 'win') {
                // Fanfare chord
                [400, 500, 600, 800].forEach((freq, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.type = 'square';
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    o.frequency.value = freq;
                    g.gain.setValueAtTime(0.05, audioCtx.currentTime + (i*0.1));
                    g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + (i*0.1) + 0.5);
                    o.start(audioCtx.currentTime + (i*0.1));
                    o.stop(audioCtx.currentTime + (i*0.1) + 0.5);
                });
            }
        }

        // --- GAME LOGIC ---
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function newGame() {
            // Pick 24 items (Center is free)
            const shuffled = shuffle([...roadItems]);
            const selected = shuffled.slice(0, 24);
            
            // Insert FREE SPACE at index 12 (Center of 25)
            selected.splice(12, 0, "FREE SPACE");
            
            boardState = selected;
            markedIndices = [12]; // Center starts marked
            
            renderBoard();
            
            // Reset Win overlay if showing
            document.getElementById('win-overlay').classList.remove('visible');
        }

        function renderBoard() {
            const grid = document.getElementById('game-board');
            grid.innerHTML = '';
            
            boardState.forEach((item, index) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.innerText = item;
                
                if (index === 12) tile.classList.add('free', 'marked');
                if (markedIndices.includes(index)) tile.classList.add('marked');
                
                tile.onclick = () => toggleTile(index);
                
                grid.appendChild(tile);
            });
        }

        function toggleTile(index) {
            if (index === 12) return; // Can't toggle free space
            
            const tile = document.getElementById('game-board').children[index];
            
            if (markedIndices.includes(index)) {
                // Unmark
                playSound('unmark');
                markedIndices = markedIndices.filter(i => i !== index);
                tile.classList.remove('marked');
            } else {
                // Mark
                playSound('mark');
                markedIndices.push(index);
                tile.classList.add('marked');
                checkWin();
            }
        }

        function checkWin() {
            // Winning Combinations (Indices 0-24)
            const wins = [
                // Rows
                [0,1,2,3,4], [5,6,7,8,9], [10,11,12,13,14], [15,16,17,18,19], [20,21,22,23,24],
                // Cols
                [0,5,10,15,20], [1,6,11,16,21], [2,7,12,17,22], [3,8,13,18,23], [4,9,14,19,24],
                // Diagonals
                [0,6,12,18,24], [4,8,12,16,20]
            ];

            // Check if any win combination is fully present in markedIndices
            const hasWin = wins.some(combo => combo.every(i => markedIndices.includes(i)));

            if (hasWin) {
                // Prevent spamming win if already won? 
                // Nah, let them feel good. But maybe check if we just triggered it.
                // For simple UX, just trigger the celebration.
                triggerWin();
            }
        }

        function triggerWin() {
            playSound('win');
            fireConfetti();
            document.getElementById('win-overlay').classList.add('visible');
        }

        function hideWin() {
            document.getElementById('win-overlay').classList.remove('visible');
        }

        function toggleTheme() {
            document.body.classList.toggle('night-mode');
        }

        // --- CONFETTI ---
        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    color: `hsl(${Math.random()*360}, 100%, 50%)`,
                    life: 150,
                    size: Math.random() * 8 + 4
                });
            }

            function animate() {
                ctx.clearRect(0,0,canvas.width, canvas.height);
                let active = false;
                particles.forEach(p => {
                    if(p.life > 0) {
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += 0.2; // Gravity
                        p.life -= 1;
                        ctx.fillStyle = p.color;
                        ctx.fillRect(p.x, p.y, p.size, p.size);
                        active = true;
                    }
                });
                if(active) requestAnimationFrame(animate);
            }
            animate();
        }

        // Init
        newGame();

    </script>
</body>
</html>
